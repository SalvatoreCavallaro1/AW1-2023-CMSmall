SELECT pagine.id,titolo,autore AS idautore,nome,datacreazione,datapubblicazione,idblocco, tipo AS tipoblocco,contenuto,priorit√† 
FROM pagine 
JOIN blocchipagine ON pagine.id = blocchipagine.idpagina 
JOIN utenti ON pagine.autore=utenti.id 
JOIN blocchicontenuto ON idblocco=blocchicontenuto.id



SELECT
    p.*,
    '[' || GROUP_CONCAT('{"idblocco":' || bp.idblocco || ',"tipo":"' || bc.tipo || '"}') || ']' AS blocchi
FROM
    pagine p
    INNER JOIN blocchipagine bp ON p.id = bp.idpagina
    INNER JOIN blocchicontenuto bc ON bp.idblocco = bc.id
WHERE
    p.id = '1'
GROUP BY
    p.id;


    SELECT
    p.*,
    u.nome,
    '[' || GROUP_CONCAT('{"idblocco":' || bp.idblocco || ',"tipo":"' || bc.tipo || '","contenuto":"' || bp.contenuto || '"}') || ']' AS blocchi
FROM
    pagine p
    INNER JOIN blocchipagine bp ON p.id = bp.idpagina
    INNER JOIN blocchicontenuto bc ON bp.idblocco = bc.id
    INNER JOIN utenti u ON p.autore = u.id
GROUP BY
    p.id;

    